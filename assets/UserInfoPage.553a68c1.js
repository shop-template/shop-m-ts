import{a as _e,J as ye,f as Oe,d as J,n as Ee,N as Te,e as y,I as V,as as Le,aG as we,E as ze,a6 as Se,l as K,k as ue,m as T,t as L,ad as je,v as xe,U as Me,b as Ve,ac as He,i as We,a5 as z,K as Ne,r as Ge,w as Xe,ae as $e,af as Ye,ah as Ke,az as qe,y as Je,o as S,c as ce,aj as $,al as fe,ai as Qe,ao as j,an as de,aH as Ze,aa as et,ab as tt,am as at,L as rt,ak as Y}from"./index.3aea5e33.js";import{C as nt,a as it}from"./index.cdf4675c.js";import{_ as ot}from"./plugin-vue_export-helper.21dcd24c.js";import{I as Be,a as lt}from"./function-call.088b9f17.js";import{B as st}from"./index.95e2d51e.js";import"./index.188b6061.js";const[ut,U,ct]=_e("uploader");function he(e,t){return new Promise(a=>{if(t==="file"){a();return}const r=new FileReader;r.onload=i=>{a(i.target.result)},t==="dataUrl"?r.readAsDataURL(e):t==="text"&&r.readAsText(e)})}function Ie(e,t){return ye(e).some(a=>a.file?Oe(t)?t(a.file):a.file.size>t:!1)}function ft(e,t){const a=[],r=[];return e.forEach(i=>{Ie(i,t)?r.push(i):a.push(i)}),{valid:a,invalid:r}}const dt=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i,ht=e=>dt.test(e);function Ue(e){return e.isImage?!0:e.file&&e.file.type?e.file.type.indexOf("image")===0:e.url?ht(e.url):typeof e.content=="string"?e.content.indexOf("data:image")===0:!1}var vt=J({props:{name:Ee,item:Te(Object),index:Number,imageFit:String,lazyLoad:Boolean,deletable:Boolean,previewSize:[Number,String,Array],beforeDelete:Function},emits:["delete","preview"],setup(e,{emit:t,slots:a}){const r=()=>{const{status:o,message:f}=e.item;if(o==="uploading"||o==="failed"){const v=o==="failed"?y(V,{name:"close",class:U("mask-icon")},null):y(Le,{class:U("loading")},null),c=ze(f)&&f!=="";return y("div",{class:U("mask")},[v,c&&y("div",{class:U("mask-message")},[f])])}},i=o=>{const{name:f,item:v,index:c,beforeDelete:w}=e;o.stopPropagation(),Se(w,{args:[v,{name:f,index:c}],done:()=>t("delete")})},n=()=>t("preview"),d=()=>{if(e.deletable&&e.item.status!=="uploading"){const o=a["preview-delete"];return y("div",{role:"button",class:U("preview-delete",{shadow:!o}),tabindex:0,"aria-label":ct("delete"),onClick:i},[o?o():y(V,{name:"cross",class:U("preview-delete-icon")},null)])}},h=()=>{if(a["preview-cover"]){const{index:o,item:f}=e;return y("div",{class:U("preview-cover")},[a["preview-cover"](K({index:o},f))])}},u=()=>{const{item:o,lazyLoad:f,imageFit:v,previewSize:c}=e;return Ue(o)?y(Be,{fit:v,src:o.content||o.url,class:U("preview-image"),width:Array.isArray(c)?c[0]:c,height:Array.isArray(c)?c[1]:c,lazyLoad:f,onClick:n},{default:h}):y("div",{class:U("file"),style:we(e.previewSize)},[y(V,{class:U("file-icon"),name:"description"},null),y("div",{class:[U("file-name"),"van-ellipsis"]},[o.file?o.file.name:o.url]),h()])};return()=>y("div",{class:U("preview")},[u(),r(),d()])}});const mt={name:ue(""),accept:T("image/*"),capture:String,multiple:Boolean,disabled:Boolean,readonly:Boolean,lazyLoad:Boolean,maxCount:ue(1/0),imageFit:T("cover"),resultType:T("dataUrl"),uploadIcon:T("photograph"),uploadText:String,deletable:L,afterRead:Function,showUpload:L,modelValue:je(),beforeRead:Function,beforeDelete:Function,previewSize:[Number,String,Array],previewImage:L,previewOptions:Object,previewFullImage:L,maxSize:{type:[Number,String,Function],default:1/0}};var gt=J({name:ut,props:mt,emits:["delete","oversize","click-upload","close-preview","click-preview","update:modelValue"],setup(e,{emit:t,slots:a}){const r=xe(),i=[],n=(s=e.modelValue.length)=>({name:e.name,index:s}),d=()=>{r.value&&(r.value.value="")},h=s=>{if(d(),Ie(s,e.maxSize))if(Array.isArray(s)){const g=ft(s,e.maxSize);if(s=g.valid,t("oversize",g.invalid,n()),!s.length)return}else{t("oversize",s,n());return}s=Ge(s),t("update:modelValue",[...e.modelValue,...ye(s)]),e.afterRead&&e.afterRead(s,n())},u=s=>{const{maxCount:g,modelValue:I,resultType:x}=e;if(Array.isArray(s)){const p=+g-I.length;s.length>p&&(s=s.slice(0,p)),Promise.all(s.map(b=>he(b,x))).then(b=>{const O=s.map((E,A)=>{const D={file:E,status:"",message:""};return b[A]&&(D.content=b[A]),D});h(O)})}else he(s,x).then(p=>{const b={file:s,status:"",message:""};p&&(b.content=p),h(b)})},o=s=>{const{files:g}=s.target;if(e.disabled||!g||!g.length)return;const I=g.length===1?g[0]:[].slice.call(g);if(e.beforeRead){const x=e.beforeRead(I,n());if(!x){d();return}if(We(x)){x.then(p=>{u(p||I)}).catch(d);return}}u(I)};let f;const v=()=>t("close-preview"),c=s=>{if(e.previewFullImage){const g=e.modelValue.filter(Ue),I=g.map(x=>(x.file&&!x.url&&(x.url=URL.createObjectURL(x.file),i.push(x.url)),x.url)).filter(Boolean);f=lt(K({images:I,startPosition:g.indexOf(s),onClose:v},e.previewOptions))}},w=()=>{f&&f.close()},l=(s,g)=>{const I=e.modelValue.slice(0);I.splice(g,1),t("update:modelValue",I),t("delete",s,n(g))},B=(s,g)=>{const I=["imageFit","deletable","previewSize","beforeDelete"],x=K(z(e,I),z(s,I,!0));return y(vt,Ne({item:s,index:g,onClick:()=>t("click-preview",s,n(g)),onDelete:()=>l(s,g),onPreview:()=>c(s)},z(e,["name","lazyLoad"]),x),z(a,["preview-cover","preview-delete"]))},m=()=>{if(e.previewImage)return e.modelValue.map(B)},k=s=>t("click-upload",s),F=()=>{if(e.modelValue.length>=e.maxCount||!e.showUpload)return;const s=e.readonly?null:y("input",{ref:r,type:"file",class:U("input"),accept:e.accept,capture:e.capture,multiple:e.multiple,disabled:e.disabled,onChange:o},null);return a.default?y("div",{class:U("input-wrapper"),onClick:k},[a.default(),s]):y("div",{class:U("upload",{readonly:e.readonly}),style:we(e.previewSize),onClick:k},[y(V,{name:e.uploadIcon,class:U("upload-icon")},null),e.uploadText&&y("span",{class:U("upload-text")},[e.uploadText]),s])},R=()=>{r.value&&!e.disabled&&r.value.click()};return Me(()=>{i.forEach(s=>URL.revokeObjectURL(s))}),Ve({chooseFile:R,closeImagePreview:w}),He(()=>e.modelValue),()=>y("div",{class:U()},[y("div",{class:U("wrapper",{disabled:e.disabled})},[m(),F()])])}});const pt=Xe(gt);/*!
 * Compressor.js v1.1.1
 * https://fengyuanchen.github.io/compressorjs
 *
 * Copyright 2018-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-10-05T02:32:40.212Z
 */function ve(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,r)}return a}function M(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?ve(Object(a),!0).forEach(function(r){wt(e,r,a[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):ve(Object(a)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(a,r))})}return e}function bt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function me(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function yt(e,t,a){return t&&me(e.prototype,t),a&&me(e,a),e}function wt(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function H(){return H=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var r in a)Object.prototype.hasOwnProperty.call(a,r)&&(e[r]=a[r])}return e},H.apply(this,arguments)}var Re={exports:{}};(function(e){typeof window!="undefined"&&function(t){var a=t.HTMLCanvasElement&&t.HTMLCanvasElement.prototype,r=t.Blob&&function(){try{return Boolean(new Blob)}catch{return!1}}(),i=r&&t.Uint8Array&&function(){try{return new Blob([new Uint8Array(100)]).size===100}catch{return!1}}(),n=t.BlobBuilder||t.WebKitBlobBuilder||t.MozBlobBuilder||t.MSBlobBuilder,d=/^data:((.*?)(;charset=.*?)?)(;base64)?,/,h=(r||n)&&t.atob&&t.ArrayBuffer&&t.Uint8Array&&function(u){var o,f,v,c,w,l,B,m,k;if(o=u.match(d),!o)throw new Error("invalid data URI");for(f=o[2]?o[1]:"text/plain"+(o[3]||";charset=US-ASCII"),v=!!o[4],c=u.slice(o[0].length),v?w=atob(c):w=decodeURIComponent(c),l=new ArrayBuffer(w.length),B=new Uint8Array(l),m=0;m<w.length;m+=1)B[m]=w.charCodeAt(m);return r?new Blob([i?B:l],{type:f}):(k=new n,k.append(l),k.getBlob(f))};t.HTMLCanvasElement&&!a.toBlob&&(a.mozGetAsFile?a.toBlob=function(u,o,f){var v=this;setTimeout(function(){f&&a.toDataURL&&h?u(h(v.toDataURL(o,f))):u(v.mozGetAsFile("blob",o))})}:a.toDataURL&&h&&(a.msToBlob?a.toBlob=function(u,o,f){var v=this;setTimeout(function(){(o&&o!=="image/png"||f)&&a.toDataURL&&h?u(h(v.toDataURL(o,f))):u(v.msToBlob(o))})}:a.toBlob=function(u,o,f){var v=this;setTimeout(function(){u(h(v.toDataURL(o,f)))})})),e.exports?e.exports=h:t.dataURLtoBlob=h}(window)})(Re);var xt=Re.exports,Bt=function(t){return typeof Blob=="undefined"?!1:t instanceof Blob||Object.prototype.toString.call(t)==="[object Blob]"},ge={strict:!0,checkOrientation:!0,maxWidth:1/0,maxHeight:1/0,minWidth:0,minHeight:0,width:void 0,height:void 0,resize:"none",quality:.8,mimeType:"auto",convertTypes:["image/png"],convertSize:5e6,beforeDraw:null,drew:null,success:null,error:null},It=typeof window!="undefined"&&typeof window.document!="undefined",C=It?window:{},W=function(t){return t>0&&t<1/0},Ut=Array.prototype.slice;function Rt(e){return Array.from?Array.from(e):Ut.call(e)}var kt=/^image\/.+$/;function q(e){return kt.test(e)}function Ct(e){var t=q(e)?e.substr(6):"";return t==="jpeg"&&(t="jpg"),".".concat(t)}var ke=String.fromCharCode;function Ft(e,t,a){var r="",i;for(a+=t,i=t;i<a;i+=1)r+=ke(e.getUint8(i));return r}var Pt=C.btoa;function At(e,t){for(var a=[],r=8192,i=new Uint8Array(e);i.length>0;)a.push(ke.apply(null,Rt(i.subarray(0,r)))),i=i.subarray(r);return"data:".concat(t,";base64,").concat(Pt(a.join("")))}function Dt(e){var t=new DataView(e),a;try{var r,i,n;if(t.getUint8(0)===255&&t.getUint8(1)===216)for(var d=t.byteLength,h=2;h+1<d;){if(t.getUint8(h)===255&&t.getUint8(h+1)===225){i=h;break}h+=1}if(i){var u=i+4,o=i+10;if(Ft(t,u,4)==="Exif"){var f=t.getUint16(o);if(r=f===18761,(r||f===19789)&&t.getUint16(o+2,r)===42){var v=t.getUint32(o+4,r);v>=8&&(n=o+v)}}}if(n){var c=t.getUint16(n,r),w,l;for(l=0;l<c;l+=1)if(w=n+l*12+2,t.getUint16(w,r)===274){w+=8,a=t.getUint16(w,r),t.setUint16(w,1,r);break}}}catch{a=1}return a}function _t(e){var t=0,a=1,r=1;switch(e){case 2:a=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90,r=-1;break;case 6:t=90;break;case 7:t=90,a=-1;break;case 8:t=-90;break}return{rotate:t,scaleX:a,scaleY:r}}var Ot=/\.\d*(?:0|9){12}\d*$/;function pe(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1e11;return Ot.test(e)?Math.round(e*t)/t:e}function _(e){var t=e.aspectRatio,a=e.height,r=e.width,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"none",n=W(r),d=W(a);if(n&&d){var h=a*t;(i==="contain"||i==="none")&&h>r||i==="cover"&&h<r?a=r/t:r=a*t}else n?a=r/t:d&&(r=a*t);return{width:r,height:a}}var Et=C.ArrayBuffer,be=C.FileReader,P=C.URL||C.webkitURL,Tt=/\.\w+$/,Lt=C.Compressor,zt=function(){function e(t,a){bt(this,e),this.file=t,this.image=new Image,this.options=M(M({},ge),a),this.aborted=!1,this.result=null,this.init()}return yt(e,[{key:"init",value:function(){var a=this,r=this.file,i=this.options;if(!Bt(r)){this.fail(new Error("The first argument must be a File or Blob object."));return}var n=r.type;if(!q(n)){this.fail(new Error("The first argument must be an image File or Blob object."));return}if(!P||!be){this.fail(new Error("The current browser does not support image compression."));return}if(Et||(i.checkOrientation=!1),P&&!i.checkOrientation)this.load({url:P.createObjectURL(r)});else{var d=new be,h=i.checkOrientation&&n==="image/jpeg";this.reader=d,d.onload=function(u){var o=u.target,f=o.result,v={};if(h){var c=Dt(f);c>1||!P?(v.url=At(f,n),c>1&&H(v,_t(c))):v.url=P.createObjectURL(r)}else v.url=f;a.load(v)},d.onabort=function(){a.fail(new Error("Aborted to read the image with FileReader."))},d.onerror=function(){a.fail(new Error("Failed to read the image with FileReader."))},d.onloadend=function(){a.reader=null},h?d.readAsArrayBuffer(r):d.readAsDataURL(r)}}},{key:"load",value:function(a){var r=this,i=this.file,n=this.image;n.onload=function(){r.draw(M(M({},a),{},{naturalWidth:n.naturalWidth,naturalHeight:n.naturalHeight}))},n.onabort=function(){r.fail(new Error("Aborted to load the image."))},n.onerror=function(){r.fail(new Error("Failed to load the image."))},C.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(C.navigator.userAgent)&&(n.crossOrigin="anonymous"),n.alt=i.name,n.src=a.url}},{key:"draw",value:function(a){var r=this,i=a.naturalWidth,n=a.naturalHeight,d=a.rotate,h=d===void 0?0:d,u=a.scaleX,o=u===void 0?1:u,f=a.scaleY,v=f===void 0?1:f,c=this.file,w=this.image,l=this.options,B=document.createElement("canvas"),m=B.getContext("2d"),k=Math.abs(h)%180===90,F=(l.resize==="contain"||l.resize==="cover")&&W(l.width)&&W(l.height),R=Math.max(l.maxWidth,0)||1/0,s=Math.max(l.maxHeight,0)||1/0,g=Math.max(l.minWidth,0)||0,I=Math.max(l.minHeight,0)||0,x=i/n,p=l.width,b=l.height;if(k){var O=[s,R];R=O[0],s=O[1];var E=[I,g];g=E[0],I=E[1];var A=[b,p];p=A[0],b=A[1]}F&&(x=p/b);var D=_({aspectRatio:x,width:R,height:s},"contain");R=D.width,s=D.height;var Q=_({aspectRatio:x,width:g,height:I},"cover");if(g=Q.width,I=Q.height,F){var Z=_({aspectRatio:x,width:p,height:b},l.resize);p=Z.width,b=Z.height}else{var ee=_({aspectRatio:x,width:p,height:b}),te=ee.width;p=te===void 0?i:te;var ae=ee.height;b=ae===void 0?n:ae}p=Math.floor(pe(Math.min(Math.max(p,g),R))),b=Math.floor(pe(Math.min(Math.max(b,I),s)));var Ce=-p/2,Fe=-b/2,Pe=p,Ae=b,N=[];if(F){var re=0,ne=0,G=i,X=n,ie=_({aspectRatio:x,width:i,height:n},{contain:"cover",cover:"contain"}[l.resize]);G=ie.width,X=ie.height,re=(i-G)/2,ne=(n-X)/2,N.push(re,ne,G,X)}if(N.push(Ce,Fe,Pe,Ae),k){var oe=[b,p];p=oe[0],b=oe[1]}B.width=p,B.height=b,q(l.mimeType)||(l.mimeType=c.type);var le="transparent";if(c.size>l.convertSize&&l.convertTypes.indexOf(l.mimeType)>=0&&(l.mimeType="image/jpeg"),l.mimeType==="image/jpeg"&&(le="#fff"),m.fillStyle=le,m.fillRect(0,0,p,b),l.beforeDraw&&l.beforeDraw.call(this,m,B),!this.aborted&&(m.save(),m.translate(p/2,b/2),m.rotate(h*Math.PI/180),m.scale(o,v),m.drawImage.apply(m,[w].concat(N)),m.restore(),l.drew&&l.drew.call(this,m,B),!this.aborted)){var se=function(De){r.aborted||r.done({naturalWidth:i,naturalHeight:n,result:De})};B.toBlob?B.toBlob(se,l.mimeType,l.quality):se(xt(B.toDataURL(l.mimeType,l.quality)))}}},{key:"done",value:function(a){var r=a.naturalWidth,i=a.naturalHeight,n=a.result,d=this.file,h=this.image,u=this.options;if(P&&!u.checkOrientation&&P.revokeObjectURL(h.src),n)if(u.strict&&n.size>d.size&&u.mimeType===d.type&&!(u.width>r||u.height>i||u.minWidth>r||u.minHeight>i||u.maxWidth<r||u.maxHeight<i))n=d;else{var o=new Date;n.lastModified=o.getTime(),n.lastModifiedDate=o,n.name=d.name,n.name&&n.type!==d.type&&(n.name=n.name.replace(Tt,Ct(n.type)))}else n=d;this.result=n,u.success&&u.success.call(this,n)}},{key:"fail",value:function(a){var r=this.options;if(r.error)r.error.call(this,a);else throw a}},{key:"abort",value:function(){this.aborted||(this.aborted=!0,this.reader?this.reader.abort():this.image.complete?this.fail(new Error("The compression process has been aborted.")):(this.image.onload=null,this.image.onabort()))}}],[{key:"noConflict",value:function(){return window.Compressor=Lt,e}},{key:"setDefaults",value:function(a){H(ge,a)}}]),e}();const St={class:"user-img-box",style:{width:"100%",display:"flex","justify-content":"flex-end"}},jt=rt("\u9000\u51FA"),Mt=J({__name:"UserInfoPage",setup(e){const t=$e();Ye();const a=Ke(),{userInfo:r}=qe(a),i=Je(()=>[{title:"\u540D\u79F0",value:r.value.name,to:"/changeName"},{title:"\u4FEE\u6539\u5BC6\u7801",value:"",to:"/changePassword"},{title:"\u6211\u7684\u5730\u5740",value:"",to:"/addressList"}]),n=5*1024*1024,d=xe();function h(){var c;(c=d.value)==null||c.chooseFile()}function u(c){const w=Y.loading({message:"\u6587\u4EF6\u538B\u7F29\u4E2D..."});return new Promise(l=>{const B=c;new zt(B,{success:m=>{w.clear(),l(m)},error(m){console.log(m.message)}})})}function o(c){Y("\u6587\u4EF6\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC7 5M")}function f(c){console.log(c);const w=new FormData,l=c;w.append("file",l==null?void 0:l.file);const B=Y.loading({message:"\u6587\u4EF6\u4E0A\u4F20\u4E2D..."});setTimeout(()=>{B.clear(),a.userInfo.headerImg=l.content},1e3)}function v(){a.loginOutFn().then(c=>{t.replace("/login")}).catch(c=>{console.log(c)})}return(c,w)=>{const l=Be,B=pt,m=nt,k=it,F=st;return S(),ce(fe,null,[y(k,null,{default:$(()=>[y(m,{title:"\u5934\u50CF","is-link":"",center:"",onClick:h},{default:$(()=>[Qe("div",St,[j(r).headerImg?(S(),de(l,{key:0,class:"user-img",src:j(r).headerImg},null,8,["src"])):Ze("",!0),et(y(B,{ref_key:"userImgUploader",ref:d,"max-size":n,"before-read":u,"after-read":f,"preview-size":"68",onOversize:o},null,512),[[tt,!j(r).headerImg]])])]),_:1}),(S(!0),ce(fe,null,at(j(i),R=>(S(),de(m,{key:R.title,title:R.title,value:R.value,to:R.to,"is-link":""},null,8,["title","value","to"]))),128))]),_:1}),y(F,{type:"primary",plain:"",block:"",color:"#fff",class:"button--text-blank_white-bg mgt-middle",onClick:v},{default:$(()=>[jt]),_:1})],64)}}});var Yt=ot(Mt,[["__scopeId","data-v-4bd8f1be"]]);export{Yt as default};
